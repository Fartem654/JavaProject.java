если бригада не успела доехать до того как заявку уже закрыли в ее назначении в оба поля ставится время окончания заявки первой бригады

Бизнесс логика
1) заявки
   На заявку можно назначить несколько бригад
   Создание:
   создается только со статусом не принято, время подачи может быть любым, но не в будущем
   Обновление:
   При статусе не принято - можно менять все, кроме id
   При статусе: принято: можно менять все кроме айди и приоритета
   в работае: можно поменять все, кроме айди приоритета, адреса
   Завершено: НИЧЕГО не меняется, нельзя назначить бригаду к ней
   Статус зависит ТОЛЬКО от назначений и меняется только программно в зависимости от связаННЫХ назначений:
   Нет назначений: "не принято", тоесть не принято бригадой
   Если все связанные назначения не имеют времени начала работ(окончания соотвественно): "принято", те бригады в пути
   Если хотя бы одно назначение имеет не пустое поле "начало работ", и ни одно назначение на эту заявку не имеет время завершения: "В работе", те хотя бы одна бригада устраняет аварию
   Если хотя бы одно связанное назначение имеет не пустое поле окончания работ: "Завершено", ПРИЧЕМ все назначения заявки имевшие время начало работ, получают время окончания от первой закончившей, бригады не имевшие времени начала работ(еще впути) получают в поля начало и окончание работ время  окончания от первой закончившей
   При удалении заявки - удаляются все назначения

Бригады:
Создание: создается со статусом свободная
обновление: два случая:
1) прямое
   обновляются непосредственно данные в объекте, например в случаях когда опечатка
2) обновление с архивированием(по правилам по)
   Если меняется состав бригады(пр. новая машина), на основе исходной бригады создается новая с тем же номером бригады, старой же в номере бригады добавляется зарезервированное окончание _v..., ее статус меняется на "расформирована", данные в ней нельзя обновлять,также ее и нельзя назначать на заявки
   Статус меняется в зависимости от таблицы назначения: по умолчанию свободна, назначили - в пути, в назначении есть время начало работ - в работе, появилось поле окончание работ: свободен
   Бригаду нельзя обновить с рхивацией или удалить, пока она устраняет аварию, те ее статус не Свободен
   Удаление:
   2 этапа:
1) "удаление" происходит присваиванием бригаде статуса "расформирована", данные в ней нельзя обновлять(решаем проблему созранения истории выездов бригады), но также ее и нельзя назначать на заявки
   2)удаление уже физическое: при попытке удаления вылезает предупреждение о полной потере данных о бригаде и о ее выездах

назначения:
При каждом взаимодействии с таблицей должно проходить обновление статусов бригад и заявок
создание: есть ограничения о вводе времени, время назнчения <время начало работ<врямя окончания
обновление:
такие же ограничения как и при создании, также особое внимание к статусам
Назначение нельзя менять, если заявка закрыта, тоесть поле окончание работ не пустое
удаление: при удалении назначения у бригады статус становится свободен
У заявки, если статус был завершена, то статус не меняется на "не принято"
Если же статус другой, то нужно смотреть по остальным назначениям этой заявки, и брать самый актуальный  статус от в работе до не принято соотвественно
